<script>
(function(){
  const modalEl = document.getElementById('programar-modalAtividade');
  const inputData = document.getElementById('programar-dataAtividade');
  const btnSalvar = document.getElementById('programar-btnSalvar');

  window.PROGRAMAR = window.PROGRAMAR || {};
  window.PROGRAMAR.openProgramarModal = function(dateStr, labelText){
    if (!modalEl) return;
    inputData.value = dateStr || '';
    const lbl = document.getElementById('programar-modalAtividadeLabel');
    if (lbl) lbl.textContent = labelText ? `Programar atividades â€” ${labelText}` : 'Programar atividades';
    bootstrap.Modal.getOrCreateInstance(modalEl).show();
    btnSalvar.disabled = true;

    // ðŸ”‘ carrega as metas da data
    try { window.PROGRAMAR.loadMetas?.(dateStr); } catch(e){ console.warn('loadMetas falhou', e); }
  };
})();
</script>
